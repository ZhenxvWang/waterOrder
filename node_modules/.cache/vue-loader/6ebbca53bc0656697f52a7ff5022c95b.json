{"remainingRequest":"E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\src\\components\\shop\\Shop.vue?vue&type=style&index=0&id=fe77d1a2&scoped=true&lang=css&","dependencies":[{"path":"E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\src\\components\\shop\\Shop.vue","mtime":1617761157845},{"path":"E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\personal\\Myshool\\ohters\\operation\\李海珍\\个人设计\\源码设计\\first_demo\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQovKiAuaW5wdXQtc2VyY2h7DQogIHdpZHRoOiAxMzBweDsNCn0gKi8NCg=="},{"version":3,"sources":["Shop.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyQA;AACA;AACA","file":"Shop.vue","sourceRoot":"src/components/shop","sourcesContent":["<template>\r\n  <div>\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item>首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>食品管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>食品列表</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <el-card>\r\n      <el-row :gutter=\"30\">\r\n        <el-col :span=\"6\">\r\n          <el-input v-model=\"queryInfo.query\" placeholder=\"请输入食品名称\" class=\"input-serch\"></el-input>\r\n        </el-col>\r\n        <el-col :span=\"3\">\r\n            <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"searchGoods\">搜索</el-button>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n            <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"toAdd\">添加</el-button>\r\n        </el-col>\r\n        <!-- <el-col :span=\"16\">\r\n          <el-button type=\"primary\" @click=\"addShop\">添加</el-button>\r\n        </el-col> -->\r\n      </el-row>\r\n      <!-- 列表形式 -->\r\n      <el-table v-loading=\"loading\" :data=\"foods\" stripe border style=\"width: 100%\">\r\n        <el-table-column type=\"index\"></el-table-column>\r\n        <el-table-column prop=\"fname\" label=\"食品名称\" align=\"center\"></el-table-column>\r\n        <el-table-column prop=\"fprice\" label=\"出售价格\" align=\"center\">\r\n           <template slot-scope=\"scope\">\r\n            <div>￥{{scope.row.fprice.toFixed(2) }}</div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"ftime\" label=\"上架时间\" align=\"center\">\r\n           <template slot-scope=\"scope\">\r\n            <div>{{scope.row.ftime | timeflow }}</div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"tid\" label=\"食品类型\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <div v-if=\"scope.row.tid==1\">热门菜品</div>\r\n            <div v-if=\"scope.row.tid==2\">特色菜品</div>\r\n            <div v-if=\"scope.row.tid==3\">精品推荐</div>\r\n            <div v-if=\"scope.row.tid==4\">香辣菜品</div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button @click=\"toEdit(scope.row)\" type=\"primary\" icon=\"el-icon-edit\" circle></el-button>\r\n            <el-button @click=\"foodDelete(scope.row.fid)\" type=\"danger\" icon=\"el-icon-delete\" circle ></el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 分页底部 -->\r\n       <el-pagination\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :current-page=\"queryInfo.pageIndex\"\r\n        :page-sizes=\"[5,10]\"\r\n        :page-size=\"queryInfo.pageSize\"\r\n        layout=\"total, sizes, prev, pager, next\"\r\n        :total=\"total\"\r\n      >\r\n      </el-pagination>\r\n    </el-card>\r\n    <!-- 修改商品的对话框 -->\r\n    <el-dialog\r\n      title=\"修改商品\"\r\n      :visible.sync=\"editShow\"\r\n      width=\"50%\"\r\n      center\r\n      @close=\"editClose\"\r\n    >\r\n      <!-- 内容主题区域 -->\r\n      <el-form :model=\"editFood\" :rules=\"editRules\" ref=\"editRules\" label-width=\"150px\">\r\n        <el-form-item label=\"食品名称\" prop=\"fname\">\r\n          <el-input v-model=\"editFood.fname\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"出售价格\" prop=\"fprice\">\r\n          <el-input type=\"number\" v-model=\"editFood.fprice\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"食品类型\" prop=\"tid\">\r\n          <el-select v-model=\"editFood.tid\" placeholder=\"请选择\">\r\n            <el-option\r\n              v-for=\"item in options\"\r\n              :key=\"item.tid\"\r\n              :label=\"item.tname\"\r\n              :value=\"item.tid\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n         <el-form-item label=\"食品描述\" prop=\"fdesc\">\r\n            <el-input\r\n            type=\"textarea\"\r\n            :autosize=\"{ minRows: 2, maxRows: 4}\"\r\n            placeholder=\"请输入内容\"\r\n            v-model=\"editFood.fdesc\">\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <!-- 底部区域 -->\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"editClose('editRules')\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"editCommit('editRules')\">确认修改</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios'\r\nimport Vue from 'vue'\r\n\r\n//过滤器，对时间格式进行转换\r\nVue.filter('timeflow',date=>{\r\n  if(!date) return ''\r\n  const da = new Date(date);\r\n  let time = da.getFullYear();\r\n  const month = da.getMonth()+1;\r\n  const day = da.getDate();\r\n  //针对月份，天进行拼接处理\r\n  if(month<10)time=time+'-0'+month;\r\n  else time = time+'-'+month;\r\n  if(day<10)time=time+'-0'+day;\r\n  else time = time+'-'+day;\r\n  return time;\r\n})\r\nexport default {\r\n  data() {\r\n     var valiNumberPass1 = (rule, value, callback) => {//正整数\r\n            if (value === '') {\r\n                callback(new Error('请输入出售价格价格'));\r\n            } else if (isNaN(parseFloat(value))) {\r\n                callback(new Error('请输正确的数值'));\r\n            } else {\r\n                callback();\r\n            }\r\n     };\r\n    return {\r\n      loading:true,\r\n      searchValue:'',\r\n      foods:[],\r\n      options:[],\r\n      editFood:{\r\n        fid:'',\r\n        fname:'',\r\n        fprice:'',\r\n        fdesc:'',\r\n        tid:'',\r\n      },\r\n      editShow:false,\r\n      queryInfo:{\r\n        query:'',\r\n        pageIndex:1,\r\n        pageSize:5\r\n      },\r\n      total:0,\r\n      editRules:{\r\n        fname:[{ required: true, message: '请输入食品名称', trigger: 'blur' }],\r\n        fprice:[{ required: true, validator:valiNumberPass1, trigger: \"blur\" }],\r\n        fdesc:[{ required: true, message: '请输入食品描述', trigger: 'blur'}],\r\n      }\r\n      \r\n    }\r\n  },\r\n  methods: {\r\n    searchGoods(){\r\n      this.getFoods();\r\n    },\r\n    toEdit(val){\r\n      //拷贝\r\n      this.editFood.fid = val.fid;\r\n      this.editFood.fname = val.fname;\r\n      this.editFood.fprice = val.fprice;\r\n      this.editFood.fdesc = val.fdesc;\r\n      this.editFood.tid = val.tid;\r\n      //请求获取食品类型\r\n      this.getFoodType();\r\n      this.editShow = true;\r\n    },\r\n    editClose(){\r\n      this.editShow = false;\r\n      //重置规则\r\n      // this.$refs[formName].resetFields(); \r\n     //会报错\r\n     //原因是：mouted加载数据以后，隐藏的弹出框并没有编译渲染进dom里面\r\n     //。所以click弹出的时候$refs并没有获取到dom元素导致 ‘resetFields’ of undefined\r\n      this.$nextTick(()=>{\r\n        this.$refs.editRules.resetFields();\r\n      });\r\n    },\r\n    toAdd(){\r\n      this.$router.push('/addshop');\r\n    },\r\n    checkGname(){\r\n      this.editFood.fname\r\n    },\r\n    editCommit(formName){\r\n      this.$refs[formName].validate(valid => {\r\n        if(valid){\r\n          //请求\r\n          axios.post('/api/dincan/admin/updateFoodBase',this.editFood).then(res=>{\r\n            if(res.data==1){\r\n              this.$message.success('修改成功！');\r\n              this.getFoods();\r\n            }else{\r\n              this.$message.error('修改失败！');\r\n            }\r\n            this.editShow = false;\r\n          })\r\n        }else{\r\n          return false;\r\n        }\r\n      })\r\n\r\n      \r\n    },\r\n    handleSizeChange(val){\r\n      this.queryInfo.pageSize = val;\r\n      this.getFoods();\r\n    },\r\n    handleCurrentChange(val){\r\n      this.queryInfo.pageIndex = val;\r\n      this.getFoods();\r\n    },\r\n    //根据id删除食品\r\n   async foodDelete(fid){\r\n      const re = await this.$confirm('此操作将永久删除该食品信息, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n      }).catch(err=>err)\r\n      if(re !='confirm'){\r\n        this.$message.info('已取消删除！')\r\n      }else{\r\n        axios.get(\"api/dincan/admin/deleteFood?fid=\"+fid).then(res=>{\r\n          if(res.data==1){\r\n            this.$message.success('删除成功！')\r\n            this.getFoods();\r\n          }else{\r\n            this.$message.error('删除失败！')\r\n          }\r\n        })\r\n      }\r\n    },\r\n    //获取所有食品类型\r\n    getFoodType(){\r\n      axios.get('/api/dincan/admin/getTypes').then(res=>{  \r\n          this.options = res.data;\r\n      })\r\n    },\r\n    //查询食品信息\r\n    getFoods(){\r\n      axios.post(\"api/dincan/admin/getFoods\",this.queryInfo).then(res=>{\r\n            this.loading = false;\r\n            this.foods = res.data.list;\r\n            this.total = res.data.count;\r\n      })\r\n    },\r\n  },\r\n  mounted() {\r\n    //获取商品数据\r\n    this.getFoods();\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n/* .input-serch{\r\n  width: 130px;\r\n} */\r\n</style>"]}]}